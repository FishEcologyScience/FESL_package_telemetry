% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fct_detection_processing.R
\name{calculate_residency}
\alias{calculate_residency}
\title{Calculate Fish Residency at Acoustic Receiver Stations}
\usage{
calculate_residency(
  data,
  animal_col = "animal_id",
  station_col = "station_no",
  timestamp_col = "detection_timestamp_est",
  date_col = "date",
  lat_col = "deploy_lat",
  long_col = "deploy_long",
  units = "hours"
)
}
\arguments{
\item{data}{A dataframe containing acoustic telemetry detection data.}

\item{animal_col}{Character. Name of column containing fish/animal identifiers.
Default is "animal_id".}

\item{station_col}{Character. Name of column containing receiver station identifiers.
Default is "station_no".}

\item{timestamp_col}{Character. Name of column containing detection timestamps.
Default is "detection_timestamp_est".}

\item{date_col}{Character. Name of column containing detection dates.
Default is "date".}

\item{lat_col}{Character. Name of column containing receiver latitude coordinates.
Default is "deploy_lat".}

\item{long_col}{Character. Name of column containing receiver longitude coordinates.
Default is "deploy_long".}

\item{units}{Character. Time units for residency calculation. One of "hours" (default),
"mins", "days", or "secs". Passed to \code{difftime()}.}
}
\value{
A dataframe with columns:
\describe{
\item{date}{Detection date}
\item{animal_id}{Fish identifier (or custom name from animal_col)}
\item{station}{Station identifier (or custom name from station_col)}
\item{residence}{Total residency time at station on that date (in specified units)}
}
}
\description{
Calculates fish residency times at acoustic receiver stations by
tracking movements between stations and computing time spent at each location.
This function identifies sequential detections at the same station and calculates
the duration between first and last detection in each residency event.
}
\details{
The function performs the following steps:
\enumerate{
\item Tracks movements by comparing current and previous detection locations
\item Calculates time lag between consecutive detections
\item Identifies unique movement events using a movement ID
\item Computes residency duration for each station visit
\item Summarizes total residency time by date, animal, and station
}

Only consecutive detections of the same individual are considered for residency
calculations. Movements between different stations reset the residency counter.
}
\examples{
\dontrun{
# Basic usage with default GLATOS column names
residency <- calculate_residency(data_det)

# Custom column names
residency <- calculate_residency(
  data = my_data,
  animal_col = "fish_id",
  station_col = "receiver",
  timestamp_col = "timestamp"
)

# Calculate residency in days instead of hours
residency <- calculate_residency(data_det, units = "days")
}

}
